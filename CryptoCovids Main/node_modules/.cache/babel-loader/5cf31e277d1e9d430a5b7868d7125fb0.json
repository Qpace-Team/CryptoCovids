{"ast":null,"code":"var _jsxFileName = \"/Users/Neo/WorkSpace/CryptoCovids Minter/src/components/Minter.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport Web3 from \"web3\";\nimport contract from \"../contracts/contract.json\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialMintState = {\n  loading: false,\n  status: `Connect your wallet and Mint your ${contract.name}`,\n  amount: 1,\n  supply: \"0\",\n  cost: \"0\"\n};\n\nfunction Minter() {\n  _s();\n\n  var _info$web;\n\n  const [info, setInfo] = useState(initialInfoState);\n  const [mintInfo, setMintInfo] = useState(initialMintState);\n  console.log(info);\n\n  const init = async (_request, _contractJSON) => {\n    if (window.ethereum.isMetaMask) {\n      try {\n        const accounts = await window.ethereum.request({\n          method: _request\n        });\n        const networkId = await window.ethereum.request({\n          method: \"net_version\"\n        });\n\n        if (networkId == _contractJSON.chain_id) {\n          let web3 = new Web3(window.ethereum);\n          setInfo(prevState => ({ ...prevState,\n            connected: true,\n            status: null,\n            account: accounts[0],\n            web3: web3,\n            contract: new web3.eth.Contract(_contractJSON.abi, _contractJSON.address),\n            contractJSON: _contractJSON\n          }));\n        } else {\n          setInfo(() => ({ ...initialInfoState,\n            status: `Change network to ${_contractJSON.chain}.`\n          }));\n        }\n      } catch (err) {\n        console.log(err.message);\n        setInfo(() => ({ ...initialInfoState\n        }));\n      }\n    } else {\n      setInfo(() => ({ ...initialInfoState,\n        status: \"Please install Metamask.\"\n      }));\n    }\n  };\n\n  const initListeners = () => {\n    if (window.ethereum) {\n      window.ethereum.on(\"accountsChanged\", () => {\n        window.location.reload();\n      });\n      window.ethereum.on(\"chainChanged\", () => {\n        window.location.reload();\n      });\n    }\n  };\n\n  const getSupply = async () => {\n    const params = {\n      to: info.contractJSON.address,\n      from: info.account,\n      data: info.contract.methods.totalSupply().encodeABI()\n    };\n\n    try {\n      const result = await window.ethereum.request({\n        method: \"eth_call\",\n        params: [params]\n      });\n      console.log(info.web3.utils.hexToNumberString(result));\n      setMintInfo(prevState => ({ ...prevState,\n        supply: info.web3.utils.hexToNumberString(result)\n      }));\n    } catch (err) {\n      setMintInfo(prevState => ({ ...prevState,\n        supply: 0\n      }));\n    }\n  };\n\n  const getCost = async () => {\n    const params = {\n      to: info.contractJSON.address,\n      from: info.account,\n      data: info.contract.methods.cost().encodeABI()\n    };\n\n    try {\n      const result = await window.ethereum.request({\n        method: \"eth_call\",\n        params: [params]\n      });\n      console.log(info.web3.utils.hexToNumberString(result));\n      setMintInfo(prevState => ({ ...prevState,\n        cost: info.web3.utils.hexToNumberString(result)\n      }));\n    } catch (err) {\n      setMintInfo(prevState => ({ ...prevState,\n        cost: \"0\"\n      }));\n    }\n  };\n\n  const mint = async () => {\n    const params = {\n      to: info.contractJSON.address,\n      from: info.account,\n      value: String(info.web3.utils.toHex(Number(mintInfo.cost) * mintInfo.amount)),\n      data: info.contract.methods.mint(mintInfo.amount).encodeABI()\n    };\n\n    try {\n      setMintInfo(prevState => ({ ...prevState,\n        loading: true,\n        status: `Minting ${mintInfo.amount} CryptoCovid ...`\n      }));\n      const txHash = await window.ethereum.request({\n        method: \"eth_sendTransaction\",\n        params: [params]\n      });\n      setMintInfo(prevState => ({ ...prevState,\n        loading: false,\n        status: \"Great! Be patient, Your CryptoCovids will show up in our Gallery and marketplaces such as Opensea, once the transaction is successful. You can check your transaction on your MetaMask.\"\n      }));\n      getSupply();\n    } catch (err) {\n      setMintInfo(prevState => ({ ...prevState,\n        loading: false,\n        status: err.message\n      }));\n    }\n  };\n\n  const updateAmount = newAmount => {\n    if (newAmount <= 20 && newAmount >= 1) {\n      setMintInfo(prevState => ({ ...prevState,\n        amount: newAmount\n      }));\n    }\n  };\n\n  const connectToContract = _contractJSON => {\n    init(\"eth_requestAccounts\", _contractJSON);\n  };\n\n  useEffect(() => {\n    connectToContract(contract);\n    initListeners();\n  }, []);\n  useEffect(() => {\n    if (info.connected) {\n      getSupply();\n      getCost();\n    }\n  }, [info.connected]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card icon-box2\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"icon\",\n      children: /*#__PURE__*/_jsxDEV(\"i\", {\n        class: \"bx bxl-creative-commons\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 11\n    }, this), mintInfo.supply < contract.total_supply ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card_body\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: !info.connected || mintInfo.cost == \"0\",\n          className: \"small_button btn btn-outline-dark\",\n          onClick: () => updateAmount(mintInfo.amount - 1),\n          children: \"-\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: 10\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: !info.connected || mintInfo.cost == \"0\",\n          className: \"button gap-6 col-10  btn btn-outline-primary\",\n          onClick: () => mint(),\n          children: [\"Mint \", mintInfo.amount]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: 10\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: !info.connected || mintInfo.cost == \"0\",\n          className: \"small_button btn btn-outline-dark\",\n          onClick: () => updateAmount(mintInfo.amount + 1),\n          children: \"+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 13\n      }, this), info.connected ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          justifyContent: \"space-between\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: \"var(--statusText)\",\n            textAlign: \"center\"\n          },\n          children: [((_info$web = info.web3) === null || _info$web === void 0 ? void 0 : _info$web.utils.fromWei(mintInfo.cost, \"ether\")) * mintInfo.amount, \" \", contract.chain_symbol]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: 20\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: \"var(--statusText)\",\n            textAlign: \"center\"\n          },\n          children: \"|\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: 20\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: \"var(--statusText)\",\n            textAlign: \"center\"\n          },\n          children: [mintInfo.supply, \"/\", contract.total_supply]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 15\n      }, this) : null, mintInfo.status ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"statusText\",\n        children: mintInfo.status\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 15\n      }, this) : null, info.status ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"statusText\",\n        style: {\n          color: \"var(--error)\"\n        },\n        children: info.status\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 15\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card_body\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: \"var(--statusText)\",\n          textAlign: \"center\"\n        },\n        children: [mintInfo.supply, \"/\", contract.total_supply]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"statusText\",\n        children: [\"We've sold out! .You can still buy and trade the \", contract.name, \" \", \"on marketplaces such as \", /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"https://opensea.io\",\n          children: \"Opensea\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 39\n        }, this), \".\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card_footer\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button button gap-2 col-10  btn btn-btn-outline-danger\",\n        style: {\n          backgroundColor: info.connected ? \"var(--success)\" : \"var(--warning)\"\n        },\n        onClick: () => connectToContract(contract),\n        children: info.account ? \"Connected\" : \"Connect Wallet\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }, this), info.connected ? /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"accountText\",\n        children: String(info.account).substring(0, 6) + \"...\" + String(info.account).substring(38)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 13\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n      style: {\n        position: \"absolute\",\n        bottom: 55,\n        left: -75\n      },\n      className: \"_90\",\n      target: \"_blank\",\n      href: \"https://rinkeby.etherscan.io/address/0xd772c2a0b9b2930c8554145e72f8688faa8a7e81\",\n      children: \"View Contract\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 187,\n    columnNumber: 7\n  }, this);\n}\n\n_s(Minter, \"mIzeChdqMe5EBrlIjA8UhRd3cSE=\");\n\n_c = Minter;\nexport default Minter;\n\nvar _c;\n\n$RefreshReg$(_c, \"Minter\");","map":{"version":3,"sources":["/Users/Neo/WorkSpace/CryptoCovids Minter/src/components/Minter.js"],"names":["useEffect","useState","Web3","contract","initialMintState","loading","status","name","amount","supply","cost","Minter","info","setInfo","initialInfoState","mintInfo","setMintInfo","console","log","init","_request","_contractJSON","window","ethereum","isMetaMask","accounts","request","method","networkId","chain_id","web3","prevState","connected","account","eth","Contract","abi","address","contractJSON","chain","err","message","initListeners","on","location","reload","getSupply","params","to","from","data","methods","totalSupply","encodeABI","result","utils","hexToNumberString","getCost","mint","value","String","toHex","Number","txHash","updateAmount","newAmount","connectToContract","total_supply","display","justifyContent","alignItems","width","color","textAlign","fromWei","chain_symbol","backgroundColor","substring","position","bottom","left"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport Web3 from \"web3\";\nimport contract from \"../contracts/contract.json\";\n\n\n\nconst initialMintState = {\n  loading: false,\n  status: `Connect your wallet and Mint your ${contract.name}`,\n  amount: 1,\n  supply: \"0\",\n  cost: \"0\",\n};\n\n\nfunction Minter() {\n  const [info, setInfo] = useState(initialInfoState);\n  const [mintInfo, setMintInfo] = useState(initialMintState);\n\n  console.log(info);\n\n  const init = async (_request, _contractJSON) => {\n    if (window.ethereum.isMetaMask) {\n      try {\n        const accounts = await window.ethereum.request({\n          method: _request,\n        });\n        const networkId = await window.ethereum.request({\n          method: \"net_version\",\n        });\n        if (networkId == _contractJSON.chain_id) {\n          let web3 = new Web3(window.ethereum);\n          setInfo((prevState) => ({\n            ...prevState,\n            connected: true,\n            status: null,\n            account: accounts[0],\n            web3: web3,\n            contract: new web3.eth.Contract(\n              _contractJSON.abi,\n              _contractJSON.address\n            ),\n            contractJSON: _contractJSON,\n          }));\n        } else {\n          setInfo(() => ({\n            ...initialInfoState,\n            status: `Change network to ${_contractJSON.chain}.`,\n          }));\n        }\n      } catch (err) {\n        console.log(err.message);\n        setInfo(() => ({\n          ...initialInfoState,\n        }));\n      }\n    } else {\n      setInfo(() => ({\n        ...initialInfoState,\n        status: \"Please install Metamask.\",\n      }));\n    }\n  };\n\n  const initListeners = () => {\n    if (window.ethereum) {\n      window.ethereum.on(\"accountsChanged\", () => {\n        window.location.reload();\n      });\n      window.ethereum.on(\"chainChanged\", () => {\n        window.location.reload();\n      });\n    }\n  };\n\n  const getSupply = async () => {\n    const params = {\n      to: info.contractJSON.address,\n      from: info.account,\n      data: info.contract.methods.totalSupply().encodeABI(),\n    };\n    try {\n      const result = await window.ethereum.request({\n        method: \"eth_call\",\n        params: [params],\n      });\n      console.log(info.web3.utils.hexToNumberString(result));\n      setMintInfo((prevState) => ({\n        ...prevState,\n        supply: info.web3.utils.hexToNumberString(result),\n      }));\n    } catch (err) {\n      setMintInfo((prevState) => ({\n        ...prevState,\n        supply: 0,\n      }));\n    }\n  };\n\n  const getCost = async () => {\n    const params = {\n      to: info.contractJSON.address,\n      from: info.account,\n      data: info.contract.methods.cost().encodeABI(),\n    };\n    try {\n      const result = await window.ethereum.request({\n        method: \"eth_call\",\n        params: [params],\n      });\n      console.log(info.web3.utils.hexToNumberString(result));\n      setMintInfo((prevState) => ({\n        ...prevState,\n        cost: info.web3.utils.hexToNumberString(result),\n      }));\n    } catch (err) {\n      setMintInfo((prevState) => ({\n        ...prevState,\n        cost: \"0\",\n      }));\n    }\n  };\n\n  const mint = async () => {\n    const params = {\n      to: info.contractJSON.address,\n      from: info.account,\n      value: String(\n        info.web3.utils.toHex(Number(mintInfo.cost) * mintInfo.amount)\n      ),\n      data: info.contract.methods\n        .mint(mintInfo.amount)\n        .encodeABI(),\n    };\n    try {\n      setMintInfo((prevState) => ({\n        ...prevState,\n        loading: true,\n        status: `Minting ${mintInfo.amount} CryptoCovid ...`,\n      }));\n      const txHash = await window.ethereum.request({\n        method: \"eth_sendTransaction\",\n        params: [params],\n      });\n      setMintInfo((prevState) => ({\n        ...prevState,\n        loading: false,\n        status:\n          \"Great! Be patient, Your CryptoCovids will show up in our Gallery and marketplaces such as Opensea, once the transaction is successful. You can check your transaction on your MetaMask.\",\n      }));\n      getSupply();\n    } catch (err) {\n      setMintInfo((prevState) => ({\n        ...prevState,\n        loading: false,\n        status: err.message,\n      }));\n    }\n  };\n\n  const updateAmount = (newAmount) => {\n    if (newAmount <= 20 && newAmount >= 1) {\n      setMintInfo((prevState) => ({\n        ...prevState,\n        amount: newAmount,\n      }));\n    }\n  };\n\n  const connectToContract = (_contractJSON) => {\n    init(\"eth_requestAccounts\", _contractJSON);\n  };\n\n  useEffect(() => {\n    connectToContract(contract);\n    initListeners();\n  }, []);\n\n  useEffect(() => {\n    if (info.connected) {\n      getSupply();\n      getCost();\n    }\n  }, [info.connected]);\n\n  return (\n      <div className=\"card icon-box2\">\n          <div class=\"icon\"><i class=\"bx bxl-creative-commons\"></i></div>\n        {mintInfo.supply < contract.total_supply ? (\n          <div className=\"card_body\">\n            <div\n              style={{\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n              }}\n            >\n              <button\n                disabled={!info.connected || mintInfo.cost == \"0\"}\n                className=\"small_button btn btn-outline-dark\"\n                onClick={() => updateAmount(mintInfo.amount - 1)}\n              >\n                -\n              </button>\n              <div style={{ width: 10 }}></div>\n              <button\n                disabled={!info.connected || mintInfo.cost == \"0\"}\n                className=\"button gap-6 col-10  btn btn-outline-primary\"\n                onClick={() => mint()}\n              >\n                Mint {mintInfo.amount}\n              </button>\n              <div style={{ width: 10 }}></div>\n              <button\n                disabled={!info.connected || mintInfo.cost == \"0\"}\n                className=\"small_button btn btn-outline-dark\"\n                onClick={() => updateAmount(mintInfo.amount + 1)}\n              >\n                +\n              </button>\n            </div>\n            {info.connected ? (\n              <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n                <p style={{ color: \"var(--statusText)\", textAlign: \"center\" }}>\n                  {info.web3?.utils.fromWei(mintInfo.cost, \"ether\") *\n                    mintInfo.amount}{\" \"}\n                  {contract.chain_symbol}\n                </p>\n                <div style={{ width: 20 }}></div>\n                <p style={{ color: \"var(--statusText)\", textAlign: \"center\" }}>\n                  |\n                </p>\n                <div style={{ width: 20 }}></div>\n                <p style={{ color: \"var(--statusText)\", textAlign: \"center\" }}>\n                  {mintInfo.supply}/{contract.total_supply}\n                </p>\n              </div>\n            ) : null}\n            {mintInfo.status ? (\n              <p className=\"statusText\">{mintInfo.status}</p>\n            ) : null}\n            {info.status ? (\n              <p className=\"statusText\" style={{ color: \"var(--error)\" }}>\n                {info.status}\n              </p>\n            ) : null}\n          </div>\n        ) : (\n          <div className=\"card_body\">\n            <p style={{ color: \"var(--statusText)\", textAlign: \"center\" }}>\n              {mintInfo.supply}/{contract.total_supply}\n            </p>\n            <p className=\"statusText\">\n              We've sold out! .You can still buy and trade the {contract.name}{\" \"}\n              on marketplaces such as <a href=\"https://opensea.io\">Opensea</a>.\n            </p>\n          </div>\n        )}\n        <div className=\"card_footer\">\n          <button\n            className=\"button button gap-2 col-10  btn btn-btn-outline-danger\"\n            style={{\n              backgroundColor: info.connected\n                ? \"var(--success)\"\n                : \"var(--warning)\",\n            }}\n            onClick={() => connectToContract(contract)}\n          >\n            {info.account ? \"Connected\" : \"Connect Wallet\"}\n          </button>\n          {info.connected ? (\n            <span className=\"accountText\">\n              {String(info.account).substring(0, 6) +\n                \"...\" +\n                String(info.account).substring(38)}\n            </span>\n          ) : null}\n        </div>\n        <a\n          style={{\n            position: \"absolute\",\n            bottom: 55,\n            left: -75,\n          }}\n          className=\"_90\"\n          target=\"_blank\"\n          href=\"https://rinkeby.etherscan.io/address/0xd772c2a0b9b2930c8554145e72f8688faa8a7e81\"\n        >\n          View Contract\n        </a>\n      </div>\n  );\n}\n\nexport default Minter;\n"]},"metadata":{},"sourceType":"module"}